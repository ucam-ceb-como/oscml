2020-11-19 23:29:24,795 INFO     initialized logging with config file= ./conf/logging.yaml , log file= ./logs/hpo_20201119_232924/oscml.log  - util.py 43   init_file_logging root [[MainThread]]
2020-11-19 23:29:24,795 INFO     current working directory=C:\my\CARES_CEP_project\repository\ZhouLiML-git - train.py 59   start root [[MainThread]]
2020-11-19 23:29:24,795 INFO     args=Namespace(config='./conf/confhpo_simplegnn.json', cv=None, dataset='CEP25000', datasetpath=None, direction='minimize', dst='.', epochs=10, featurizer='full', jobs=1, load_if_exists=False, log_dir='./logs/hpo_20201119_232924', metric='val_loss', seed=200, src='.', storage=None, study_name=None, timeout=None, trials=1) - train.py 63   start root [[MainThread]]
2020-11-19 23:29:24,801 INFO     config={'dataset': {'src': './data/processed/CEP25000.csv', 'z-stand': 'False', 'x_column': ['smiles'], 'y_column': ['pce']}, 'model': {'name': 'SimpleGNN', 'model_specific': {'embedding_dimension': {'type': 'int', 'low': 16, 'high': 32}, 'conv_layers': {'type': 'int', 'low': 1, 'high': 4}, 'conv_dims': {'type': 'int', 'low': 10, 'high': 15, 'direction': 'constant'}, 'mlp_layers': {'type': 'int', 'low': 1, 'high': 4}, 'mlp_units': {'type': 'int', 'low': 5, 'high': 15, 'direction': 'increasing'}, 'mlp_dropouts': {'type': 'uniform', 'low': 0.1, 'high': 0.3, 'direction': 'constant'}}, 'dataloader': {'type_dict': 'label'}}, 'training': {'opt_name': 'Adam', 'lr': {'type': 'loguniform', 'low': 1e-05, 'high': 0.01}, 'epochs': 300, 'batch_size': 40, 'patience': -1, 'metric': 0, 'seed': 1}} - train.py 71   start root [[MainThread]]
2020-11-19 23:29:24,802 INFO     initialized Mol2Seq with radius=1, oov=True, max_index=55 - model_bilstm.py 45   __init__ root [[MainThread]]
2020-11-19 23:29:24,802 INFO     number of fragment types=56 - dataset_cep.py 178  create_dataset_info_for_CEP25000 root [[MainThread]]
2020-11-19 23:29:24,802 INFO     number_node_types=8 - dataset_cep.py 179  create_dataset_info_for_CEP25000 root [[MainThread]]
2020-11-19 23:29:24,803 INFO     reading ./data/processed/CEPDB_25000.csv - dataset.py 114  read_and_split root [[MainThread]]
2020-11-19 23:29:24,885 INFO     split data into sets of size (train val test)= 15000 5000 5000  - dataset.py 119  read_and_split root [[MainThread]]
2020-11-19 23:29:24,887 INFO     calculated target mean= 4.126659584567247 , target std= 2.407382175602577  - dataset.py 59   create_transformer root [[MainThread]]
2020-11-19 23:29:24,889 INFO     starting HPO - optunawrapper.py 69   start_hpo root [[MainThread]]
2020-11-19 23:29:24,891 INFO     starting trial 0 / 1 - optunawrapper.py 15   decorator root [[MainThread]]
2020-11-19 23:29:24,892 INFO     initialized Mol2Seq with radius=1, oov=True, max_index=55 - model_bilstm.py 45   __init__ root [[MainThread]]
2020-11-19 23:29:24,893 INFO     number of fragment types=56 - dataset_cep.py 178  create_dataset_info_for_CEP25000 root [[MainThread]]
2020-11-19 23:29:24,893 INFO     number_node_types=8 - dataset_cep.py 179  create_dataset_info_for_CEP25000 root [[MainThread]]
2020-11-19 23:29:24,893 INFO     initialized Mol2Seq with radius=1, oov=True, max_index=55 - model_bilstm.py 45   __init__ root [[MainThread]]
2020-11-19 23:29:24,894 INFO     number of fragment types=56 - dataset_cep.py 178  create_dataset_info_for_CEP25000 root [[MainThread]]
2020-11-19 23:29:24,896 INFO     number_node_types=8 - dataset_cep.py 179  create_dataset_info_for_CEP25000 root [[MainThread]]
2020-11-19 23:29:24,896 INFO     initialized Mol2seq_simple with fix=True, oov=True, max_index=7 - model_gnn.py 36   __init__ root [[MainThread]]
2020-11-19 23:29:24,897 INFO     batch numbers - train val test=[60, 20, 20] - model_gnn.py 125  get_dataloaders_internal root [[MainThread]]
2020-11-19 23:29:24,897 INFO     model params={'embedding_dim': 30, 'conv_dims': [11, 11, 11, 11], 'mlp_units': [11, 13, 1], 'mlp_dropouts': [0.19121619709165055, 0.19121619709165055], 'node_type_number': 8, 'padding_index': 0, 'target_mean': 4.126659584567247, 'target_std': 2.407382175602577} - hpo_simplegnn.py 44   create root [[MainThread]]
2020-11-19 23:29:24,898 INFO     initializing OscmlModule with {'optimizer': {'name': 'SGD', 'lr': 0.0009474897426812621, 'weight_decay': 0.0014855905320063335, 'momentum': 0.0025760976544252547, 'nesterov': False}, 'target_mean': 4.126659584567247, 'target_std': 2.407382175602577} - util_lightning.py 45   __init__ root [[MainThread]]
2020-11-19 23:29:24,898 INFO     initializing {'self': SimpleGNN(), 'node_type_number': 8, 'embedding_dim': 30, 'conv_dims': [11, 11, 11, 11], 'mlp_units': [11, 13, 1], 'padding_index': 0, 'target_mean': 4.126659584567247, 'target_std': 2.407382175602577, 'optimizer': {'name': 'SGD', 'lr': 0.0009474897426812621, 'weight_decay': 0.0014855905320063335, 'momentum': 0.0025760976544252547, 'nesterov': False}, 'mlp_dropouts': [0.19121619709165055, 0.19121619709165055], '__class__': <class 'oscml.models.model_gnn.SimpleGNN'>} - model_gnn.py 159  __init__ root [[MainThread]]
2020-11-19 23:29:24,899 INFO     padding index for embedding was set to 0 . Thus unknown atom types can be handled. - model_gnn.py 165  __init__ root [[MainThread]]
2020-11-19 23:29:24,902 INFO     model for trial 0=SimpleGNN(
  (embedding): Embedding(9, 30, padding_idx=0)
  (conv_modules): ModuleList(
    (0): SimpleGNNLayer(
      (linear): Linear(in_features=30, out_features=11, bias=True)
    )
    (1): SimpleGNNLayer(
      (linear): Linear(in_features=11, out_features=11, bias=True)
    )
    (2): SimpleGNNLayer(
      (linear): Linear(in_features=11, out_features=11, bias=True)
    )
    (3): SimpleGNNLayer(
      (linear): Linear(in_features=11, out_features=11, bias=True)
    )
  )
  (mlp): Sequential(
    (0): Linear(in_features=11, out_features=11, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.19121619709165055, inplace=False)
    (3): Linear(in_features=11, out_features=13, bias=True)
    (4): ReLU()
    (5): Dropout(p=0.19121619709165055, inplace=False)
    (6): Linear(in_features=13, out_features=1, bias=True)
  )
) - objective.py 35   fit_or_test root [[MainThread]]
2020-11-19 23:29:24,905 INFO     params for Lightning trainer={'log_every_n_steps': 1, 'flush_logs_every_n_steps': 10, 'progress_bar_refresh_rate': 1, 'checkpoint_callback': <pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x000001E4833EB748>, 'gpus': 0, 'max_epochs': 10, 'logger': <pytorch_lightning.loggers.csv_logs.CSVLogger object at 0x000001E4833EBAC8>, 'callbacks': [<oscml.hpo.objective.MetricsCallback object at 0x000001E4847DF288>, <optuna.integration.pytorch_lightning.PyTorchLightningPruningCallback object at 0x000001E4833EB608>]} - objective.py 58   fit_or_test root [[MainThread]]
2020-11-19 23:29:24,907 INFO     fitting trial 0 / 1 - objective.py 63   fit_or_test root [[MainThread]]
2020-11-19 23:29:24,909 INFO     created optimizer=SGD (
Parameter Group 0
    dampening: 0
    lr: 0.0009474897426812621
    momentum: 0.0025760976544252547
    nesterov: False
    weight_decay: 0.0014855905320063335
) - util_lightning.py 62   configure_optimizers root [[MainThread]]
2020-11-19 23:29:26,618 INFO     result={'phase': 'val', 'val_loss': 1.010963937169675, 'epoch': 0, 'time': '2020-11-19 23:29:26.618921', 'mse': 5.8590303160082255, 'rmse': 2.420543392713344, 'R2': -0.07588667511056046, 'r': -0.07675108192149944, 'mae': 1.8997999125858045, 'count': 500} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:30:18,975 INFO     result={'phase': 'val', 'val_loss': 1.0382815247447281, 'epoch': 0, 'time': '2020-11-19 23:30:18.975030', 'mse': 6.017349092650781, 'rmse': 2.453028555204929, 'R2': -0.038650425235873476, 'r': -0.06946849183981514, 'mae': 1.9448191002509685, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:31:17,352 INFO     result={'phase': 'val', 'val_loss': 1.0246932490493943, 'epoch': 1, 'time': '2020-11-19 23:31:17.352093', 'mse': 5.9385983911528335, 'rmse': 2.4369239608885693, 'R2': -0.025057321638416452, 'r': -0.04244271777577094, 'mae': 1.9475285006387304, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:32:16,667 INFO     result={'phase': 'val', 'val_loss': 1.0149430547666358, 'epoch': 2, 'time': '2020-11-19 23:32:16.667131', 'mse': 5.882091248030018, 'rmse': 2.425302300339077, 'R2': -0.015303663120405764, 'r': 0.09080700205594291, 'mae': 1.9512659954680185, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:33:21,139 INFO     result={'phase': 'val', 'val_loss': 1.008622151020649, 'epoch': 3, 'time': '2020-11-19 23:33:21.139864', 'mse': 5.845458520283081, 'rmse': 2.417738306823772, 'R2': -0.008980513563007664, 'r': 0.08806754434802672, 'mae': 1.956486848876185, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:34:37,255 INFO     result={'phase': 'val', 'val_loss': 1.005318071860719, 'epoch': 4, 'time': '2020-11-19 23:34:37.255874', 'mse': 5.826309766056776, 'rmse': 2.4137750031966063, 'R2': -0.005675260466726284, 'r': 0.05150951414584276, 'mae': 1.9613799896124946, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:36:38,110 INFO     result={'phase': 'val', 'val_loss': 1.0033120242661222, 'epoch': 5, 'time': '2020-11-19 23:36:38.110430', 'mse': 5.814683739410363, 'rmse': 2.41136553417568, 'R2': -0.003668500125224794, 'r': 0.03405038586445385, 'mae': 1.9653721325596074, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:37:42,851 INFO     result={'phase': 'val', 'val_loss': 1.0020496465375326, 'epoch': 6, 'time': '2020-11-19 23:37:42.851509', 'mse': 5.807367643246965, 'rmse': 2.409848053974973, 'R2': -0.002405673874964487, 'r': 0.03202925788836422, 'mae': 1.9684619298440793, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:38:46,708 INFO     result={'phase': 'val', 'val_loss': 1.0011199312554349, 'epoch': 7, 'time': '2020-11-19 23:38:46.708005', 'mse': 5.801979488612768, 'rmse': 2.4087298496537066, 'R2': -0.001475628265864115, 'r': 0.025765142370642206, 'mae': 1.9715782837781974, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:39:51,036 INFO     result={'phase': 'val', 'val_loss': 1.0005265637776306, 'epoch': 8, 'time': '2020-11-19 23:39:51.036733', 'mse': 5.798540633958149, 'rmse': 2.4080159123141502, 'R2': -0.0008820499651289726, 'r': 0.03218966985977757, 'mae': 1.9736778025467545, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:40:59,878 INFO     result={'phase': 'val', 'val_loss': 1.000067912396789, 'epoch': 9, 'time': '2020-11-19 23:40:59.878158', 'mse': 5.795882524953438, 'rmse': 2.4074639197615064, 'R2': -0.0004232356258648817, 'r': 0.044852720042129625, 'mae': 1.9752231019311002, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:40:59,925 INFO     finished fitting for trial 0 with val_loss = 1.000067912396789 - objective.py 68   fit_or_test root [[MainThread]]
2020-11-19 23:40:59,925 INFO     testing trial 0 / 1 - objective.py 71   fit_or_test root [[MainThread]]
2020-11-19 23:41:15,047 INFO     result={'phase': 'test', 'epoch': 9, 'time': '2020-11-19 23:41:15.047002', 'mse': 5.80646424256214, 'rmse': 2.409660607339162, 'R2': -0.00048013987776029943, 'r': 0.03713689895124901, 'mae': 1.9768319935035092, 'count': 5000} - util_lightning.py 138  shared_epoch_end root [[MainThread]]
2020-11-19 23:41:15,092 INFO     finished trial 0 / 1 - optunawrapper.py 17   decorator root [[MainThread]]
2020-11-19 23:41:15,167 INFO     current study statistics: number of trials={'all': 1, 'running': 0, 'completed': 1, 'pruned': 0, 'failed': 0} - optunawrapper.py 51   callback_on_trial_finished root [[MainThread]]
2020-11-19 23:41:15,169 INFO     finished HPO - optunawrapper.py 73   start_hpo root [[MainThread]]
2020-11-19 23:41:15,170 INFO     Saving HPO results to ./logs/hpo_20201119_232924/hpo_result.csv - optunawrapper.py 90   log_and_save root [[MainThread]]
2020-11-19 23:41:15,191 INFO     final study statistics: number of trials={'all': 1, 'running': 0, 'completed': 1, 'pruned': 0, 'failed': 0} - optunawrapper.py 95   log_and_save root [[MainThread]]
2020-11-19 23:41:15,192 INFO     best trial number=0 - optunawrapper.py 98   log_and_save root [[MainThread]]
2020-11-19 23:41:15,192 INFO     best trial value=1.000067912396789 - optunawrapper.py 99   log_and_save root [[MainThread]]
2020-11-19 23:41:15,195 INFO     best trial params={'opt_name': 'SGD', 'lr': 0.0009474897426812621, 'weight_decay': 0.0014855905320063335, 'momentum': 0.0025760976544252547, 'nesterov': False, 'embedding_dim': 30, 'conv_layers': 4, 'conv_dims_0': 11, 'mlp_layers': 2, 'mlp_units_0': 11, 'mlp_units_1': 13, 'mlp_dropouts_0': 0.19121619709165055} - optunawrapper.py 100  log_and_save root [[MainThread]]
